<!DOCTYPE html>
<html>
<head>
    <title>POS</title>
    <style>
	    body, html {
	    	height: 98%;
		}
		.gridVenta {
			width: 100%;
		}
		.headGridVenta {
			background-color: #3498db;
			height: 2em;
			border: 0px solid black;
			color:white;
			padding-left: 1%;
			font-weight: bold;
		}
		.rowGridVenta {
			height: 2em;
			border: 0px solid black;
			color:black;
			padding-left: 1%;
			font-size: 130%;
			border-bottom: 1px solid #3498db;
			padding:3% 3% 3% 3%;
		}
		.rowGridVenta input[type=text] {
        width: 100%;
        text-align:center;
    	}		

		.divGridTotales {
			height: 6em;
		}
		.gridTotales {
			width: 100%;
			height: 100%;
		}
		.tdGridTotal{
			border: 0px solid black;
			font-weight: bold;
		}
		/****************************************************/
		#tdImpuestosVenta {
			text-align: right;
			padding: 3px 3px 3px 3px;
			font-size: 220%;
			font-weight: bold;
		}
		#btn_total {
			width: 100%;
			height: 100%;
			font-weight: bold;
			text-align: right;
			font-size: 250%;
			border-radius: 5px;
			color:#3498db;
			background-color: white;
			border: 1px solid #3498db;
		}
    </style>
</head>
<body><br><br><br><br>
	<div id="leftFrame" style="background-color:red;width:50%;float:left;overflow-y:scroll;height:45px;"><br>
			<table id="GridLote" class="GridLote" width="100%">
				<tr>
					<td class="headGridLote" width="90%">Lote</td>
					<td class="headGridLote" width="10%">Inventario</td>
				</tr>
				<tr>
					<td class="rowGridLote" width="90%">EFM2343232ASASDA3012123392932032030293</td>
					<td class="rowGridLote" width="10%">2 pzas</td>
				</tr>				
				<tr>
					<td class="rowGridLote" width="90%">EFM2343232ASASDA3012123392932032030293</td>
					<td class="rowGridLote" width="10%">2 pzas</td>
				</tr>								
				<tr>
					<td class="rowGridLote" width="90%">EFM2343232ASASDA3012123392932032030293</td>
					<td class="rowGridLote" width="10%">2 pzas</td>
				</tr>				
				<tr>
					<td class="rowGridLote" width="90%">EFM2343232ASASDA3012123392932032030293</td>
					<td class="rowGridLote" width="10%">2 pzas</td>
				</tr>												
			</table>
	</div>
	<div id="rightFrame" style="width:50%;float:left">
		<div id="divGridVenta" width="100%">
		</div>
		<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
		<hr>
		<div id="divGridTotales" class="divGridTotales" style="background-color:white;">
			<table id="gridTotales" class="gridTotales"><tr><td rowspan="2" class="tdGridTotal" width="60%"></td><td  class="tdGridTotal">Impuestos:</td><td id="tdImpuestosVenta">$0.00</td></tr><tr><td colspan="2" class="tdGridTotal" height="65%;"><input type="button" class="btn_total" id="btn_total" value="$0.00"/></td></tr></table>
		</div>
		<hr>
		<div id="divGridUpc" width="100%">
			<input type="text" class="txtGridUpc" id="txtGridUpc" size="80">
		</div>
	</div>	
</body>
<script type="text/javascript">
$( document ).ready(function() {
	// Cargar panel derecho
	loadGrid();
	$( "#txtGridUpc").focus();
	$(document).on('change', '.txtGridUpc', function (e) {
		console.log("Captura UPC");
		var producto_id = document.getElementById("txtGridUpc").value;
		$.ajax({
		  type:"GET",
		  dataType : 'json',
		  url: "api/v1/posproductos?producto_id=" + producto_id,
		  success: function(datos){
		  console.log("Producto", datos);
		  addProduct(datos);
		},
		  error:  function(){ 
		  	console.log("Ha ocurrido el error.");
		  }
		}); 	
		document.getElementById("txtGridUpc").value = "";	

	});	
});
/*************************************** FUNCIONES *************************************************************************/
function loadGrid() {
	var table = '<table id="gridVenta" class="gridVenta"><tr><td class="headGridVenta" width="50%">Producto</td><td class="headGridVenta" width="20%">Precio</td><td class="headGridVenta" width="10%">Cant.</td><td class="headGridVenta" width="20%">Total</td></tr>';
				/*<tr>
					<td class="rowGridVenta" width="50%">Dimoximin 200ml</td>
					<td align="right" class="rowGridVenta" width="20%">$12,000.00</td>
					<td align="center" class="rowGridVenta" width="10%"><input type="text" id="qtyGridVenta" class="qtyGridVenta" value="1"/></td>
					<td align="right" class="rowGridVenta" width="20%">$12,000.00</td>
				</tr>
				<tr>
					<td class="rowGridVenta" width="50%">Dimoximin 300ml</td>
					<td align="right" class="rowGridVenta" width="20%">$13,000.00</td>
					<td align="center" class="rowGridVenta" width="10%"><input type="text" id="qtyGridVenta" class="qtyGridVenta" value="1"/></td>
					<td align="right" class="rowGridVenta" width="20%">$13,000.00</td>
				</tr>*/				
	table += '</table>';
	//document.getElementById('divGridVenta').innerHTML = table;
	document.getElementById("divGridVenta").innerHTML = table;
}
function addProduct(json) {
	var jsonObject = json.response;
	var datosProducto = [];
  	for (var i=0;i<jsonObject.totalRows;i++) {
  		datosProducto.push(jsonObject.data[i].name);
  		datosProducto.push("0.00");
  	}
	var table = document.getElementById("gridVenta");
	var lon = document.getElementById("gridVenta").rows.length;
	var row = table.insertRow(lon);
	var cell1 = row.insertCell(0);
	var cell2 = row.insertCell(1);
	var cell3 = row.insertCell(2);
	var cell4 = row.insertCell(3);
	cell1.innerHTML = datosProducto[0];
	cell2.innerHTML = datosProducto[1];
	cell3.innerHTML = '<input type="text" id="qtyGridVenta_' + lon + '" class="qtyGridVenta" value=""/>';
	$( "#qtyGridVenta_" + lon).focus();
	// Display
	cell1.style.width = "50%";
	cell1.className = "rowGridVenta";
	cell2.style.width = "20%";
	cell2.className = "rowGridVenta";
	cell3.style.width = "10%";
	cell3.className = "rowGridVenta";
	cell4.style.width = "20%";
	cell4.className = "rowGridVenta";
}
</script>
</html>